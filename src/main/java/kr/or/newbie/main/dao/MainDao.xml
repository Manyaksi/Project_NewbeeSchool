<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
                 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.or.newbie.main.dao.MainDao">
	<select id="showProjectMain" resultType="java.util.Map" >
		select first_page, group_no, program_name, group_category, pass_fail, group_location, group_subject, group_content, startline, deadline, group_maxcount, nickname, count
        from(select ceil(rownum/8) first_page, group_no, program_name, group_category, pass_fail, group_location, group_subject, group_content, startline, deadline, group_maxcount, nickname, count
        	 from(select rownum, group_no, program_name, group_category, pass_fail, group_location, group_subject, group_content, to_char(startline,'YYYY. MM. DD') as STARTLINE, to_char(deadline,'YYYY. MM. DD') as DEADLINE, group_maxcount, nickname, count
        		  from( select g.group_no, g.program_name, g.group_category, g.pass_fail, g.group_location, g.group_subject, g.group_content, g.startline, g.deadline, g.group_maxcount, u.nickname, count(m.user_no) AS count
                		from users u, grouparticle g, groupmember m
                		where g.user_no = u.user_no and g.group_no = m.group_no
                		group by g.group_no, g.program_name, g.group_category, g.pass_fail, g.group_location, g.group_subject, g.group_content, g.startline, g.deadline, g.group_maxcount , u.nickname
                		order by group_no desc)))
         where first_page = 1
	</select> 
	
	<select id="showProjectAdd" resultType="java.util.Map" parameterType="Integer">
		select first_page, group_no, program_name, group_category, pass_fail, group_location, group_subject, group_content, startline, deadline, group_maxcount, nickname, count
        from(select ceil(rownum/8) first_page, group_no, program_name, group_category, pass_fail, group_location, group_subject, group_content, startline, deadline, group_maxcount, nickname, count
        	 from(select rownum, group_no, program_name, group_category, pass_fail, group_location, group_subject, group_content, to_char(startline,'YYYY. MM. DD') as STARTLINE, to_char(deadline,'YYYY. MM. DD') as DEADLINE, group_maxcount, nickname, count
        		  from( select g.group_no, g.program_name, g.group_category, g.pass_fail, g.group_location, g.group_subject, g.group_content, g.startline, g.deadline, g.group_maxcount, u.nickname, count(m.user_no) AS count
                		from users u, grouparticle g, groupmember m
                		where g.user_no = u.user_no and g.group_no = m.group_no
                		group by g.group_no, g.program_name, g.group_category, g.pass_fail, g.group_location, g.group_subject, g.group_content, g.startline, g.deadline, g.group_maxcount , u.nickname
                		order by group_no desc)))
         where first_page = #{pageNo}
	</select> 
	
		<select id="showProjectProgramAdd" resultType="java.util.Map" parameterType="java.util.Map">
		select first_page, group_no, program_name, group_category, pass_fail, group_location, group_subject, group_content, startline, deadline, group_maxcount, nickname, count
        from(select ceil(rownum/8) first_page, group_no, program_name, group_category, pass_fail, group_location, group_subject, group_content, startline, deadline, group_maxcount, nickname, count
             from(select rownum, group_no, program_name, group_category, pass_fail, group_location, group_subject, group_content, to_char(startline,'YYYY. MM. DD') as STARTLINE, to_char(deadline,'YYYY. MM. DD') as DEADLINE, group_maxcount, nickname, count
                  from( select g.group_no, g.program_name, g.group_category, g.pass_fail, g.group_location, g.group_subject, g.group_content, g.startline, g.deadline, g.group_maxcount, u.nickname, count(m.user_no) AS count
                        from users u, grouparticle g, groupmember m
                        where g.user_no = u.user_no and g.group_no = m.group_no and g.program_name=#{programName}
                        group by g.group_no, g.program_name, g.group_category, g.pass_fail, g.group_location, g.group_subject, g.group_content, g.startline, g.deadline, g.group_maxcount , u.nickname
                        order by group_no desc)))
         where first_page = #{pageNo}
	</select> 
	
	
	<select id="countGroup" resultType="Integer">
		select count(group_no)
 		from grouparticle
 		where pass_fail = 0
	</select>
	
	<select id="countArticle" resultType="Integer">
		select count(article_no)
 		from article
	</select>
	
	<select id="countArticleComment" resultType="Integer">
		select count(comment_no)
     	from articomment
	</select>
	
</mapper>